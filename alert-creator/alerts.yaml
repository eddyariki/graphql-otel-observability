apiVersion: 1
groups:
- orgId: 1
  name: GraphQL Latency Alerts
  folder: GraphQL
  interval: 1m
  rules:
  - uid: a5ef14c3-f3de-
    title: p95 Author Query above 1s
    condition: C
    data:
    - refId: A
      relativeTimeRange:
        from: 600
        to: 0
      datasourceUid: prometheus
      model:
        editorMode: code
        expr: histogram_quantile(0.95, sum(rate(traces_spanmetrics_latency_bucket{graphql_field_type="Author"}[1m]))
          by (le))
        instant: true
        intervalMs: 1000
        legendFormat: __auto
        maxDataPoints: 43200
        range: false
        refId: A
    - refId: C
      datasourceUid: __expr__
      model:
        conditions:
        - evaluator:
            params:
            - 1
            type: gt
          operator:
            type: and
          query:
            params:
            - C
          reducer:
            params: []
            type: last
          type: query
        datasource:
          type: __expr__
          uid: __expr__
        expression: A
        intervalMs: 1000
        maxDataPoints: 43200
        refId: C
        type: threshold
    noDataState: NoData
    execErrState: Error
    for: 1m
    annotations: {}
    labels: {}
    isPaused: false
    notification_settings:
      receiver: grafana-default-email
  - uid: afaaf79a-7cc1-
    title: p95 Book Query above 1s
    condition: C
    data:
    - refId: A
      relativeTimeRange:
        from: 600
        to: 0
      datasourceUid: prometheus
      model:
        editorMode: code
        expr: histogram_quantile(0.95, sum(rate(traces_spanmetrics_latency_bucket{graphql_field_type="Book"}[1m]))
          by (le))
        instant: true
        intervalMs: 1000
        legendFormat: __auto
        maxDataPoints: 43200
        range: false
        refId: A
    - refId: C
      datasourceUid: __expr__
      model:
        conditions:
        - evaluator:
            params:
            - 1
            type: gt
          operator:
            type: and
          query:
            params:
            - C
          reducer:
            params: []
            type: last
          type: query
        datasource:
          type: __expr__
          uid: __expr__
        expression: A
        intervalMs: 1000
        maxDataPoints: 43200
        refId: C
        type: threshold
    noDataState: NoData
    execErrState: Error
    for: 1m
    annotations: {}
    labels: {}
    isPaused: false
    notification_settings:
      receiver: grafana-default-email
  - uid: 70b5621e-e5c4-
    title: p95 [Author] Query above 1s
    condition: C
    data:
    - refId: A
      relativeTimeRange:
        from: 600
        to: 0
      datasourceUid: prometheus
      model:
        editorMode: code
        expr: histogram_quantile(0.95, sum(rate(traces_spanmetrics_latency_bucket{graphql_field_type="[Author]"}[1m]))
          by (le))
        instant: true
        intervalMs: 1000
        legendFormat: __auto
        maxDataPoints: 43200
        range: false
        refId: A
    - refId: C
      datasourceUid: __expr__
      model:
        conditions:
        - evaluator:
            params:
            - 1
            type: gt
          operator:
            type: and
          query:
            params:
            - C
          reducer:
            params: []
            type: last
          type: query
        datasource:
          type: __expr__
          uid: __expr__
        expression: A
        intervalMs: 1000
        maxDataPoints: 43200
        refId: C
        type: threshold
    noDataState: NoData
    execErrState: Error
    for: 1m
    annotations: {}
    labels: {}
    isPaused: false
    notification_settings:
      receiver: grafana-default-email
  - uid: 935b2f2a-e4f3-
    title: p95 [Book] Query above 1s
    condition: C
    data:
    - refId: A
      relativeTimeRange:
        from: 600
        to: 0
      datasourceUid: prometheus
      model:
        editorMode: code
        expr: histogram_quantile(0.95, sum(rate(traces_spanmetrics_latency_bucket{graphql_field_type="[Book]"}[1m]))
          by (le))
        instant: true
        intervalMs: 1000
        legendFormat: __auto
        maxDataPoints: 43200
        range: false
        refId: A
    - refId: C
      datasourceUid: __expr__
      model:
        conditions:
        - evaluator:
            params:
            - 1
            type: gt
          operator:
            type: and
          query:
            params:
            - C
          reducer:
            params: []
            type: last
          type: query
        datasource:
          type: __expr__
          uid: __expr__
        expression: A
        intervalMs: 1000
        maxDataPoints: 43200
        refId: C
        type: threshold
    noDataState: NoData
    execErrState: Error
    for: 1m
    annotations: {}
    labels: {}
    isPaused: false
    notification_settings:
      receiver: grafana-default-email
